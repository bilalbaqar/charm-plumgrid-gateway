test:
  series: 'trusty'
  relations:
  - - neutron-iovisor
    - plumgrid-gateway
  - - neutron-iovisor
    - neutron-plumgrid-plugin
  - - keystone
    - neutron-plumgrid-plugin
  - - neutron-api
    - neutron-plumgrid-plugin
  - - nova-cloud-controller
    - nova-compute
  - - glance
    - nova-compute
  - - nova-compute
    - rabbitmq-server
  - - mysql
    - nova-compute
  - - cinder
    - nova-cloud-controller
  - - nova-cloud-controller
    - rabbitmq-server
  - - glance
    - nova-cloud-controller
  - - keystone
    - nova-cloud-controller
  - - mysql
    - nova-cloud-controller
  - - neutron-api
    - nova-cloud-controller
  services:
    plumgrid-gateway:
      charm: cs:~plumgrid-team/trusty/plumgrid-gateway
      num_units: 1
      options:
        external-interface: 'eth1'
      to: 'nova-compute'
    cinder:
      charm: cs:trusty/cinder
      num_units: 1
      options:
        openstack-origin: cloud:trusty-juno
      to: 'lxc:0'
    glance:
      charm: cs:trusty/glance
      num_units: 1
      options:
        openstack-origin: cloud:trusty-juno
      to: 'lxc:0'
    keystone:
      charm: cs:trusty/keystone
      num_units: 1
      options:
        admin-password: plumgrid
        openstack-origin: cloud:trusty-juno
      to: 'lxc:0'
    mysql:
      charm: cs:trusty/mysql
      num_units: 1
      to: 'lxc:0'
    neutron-api:
      charm: cs:~plumgrid-team/trusty/neutron-api
      num_units: 1
      options:
        neutron-plugin: "plumgrid"
        neutron-security-groups: "false"
        openstack-origin: "cloud:trusty-juno"
        plumgrid-password: "plumgrid"
        plumgrid-username: "plumgrid"
        plumgrid-virtual-ip: "192.168.100.250"
      to: 'lxc:0'
    neutron-plumgrid-plugin:
      charm: cs:~plumgrid-team/trusty/neutron-plumgrid-plugin
      options:
        install_keys: 'null'
        install_sources: "deb http://54.193.161.94/debs/plumgrid/ ./"
    neutron-iovisor:
      charm: cs:~plumgrid-team/trusty/neutron-iovisor
      num_units: 1
      options:
        install_keys: 'null'
        install_sources: "deb http://54.193.161.94/debs/plumgrid/ ./"
      to: 'nova-compute'
    nova-cloud-controller:
      charm: cs:trusty/nova-cloud-controller
      num_units: 1
      options:
        console-access-protocol: novnc
        network-manager: Neutron
        openstack-origin: cloud:trusty-juno
        quantum-security-groups: 'yes'
      to: 'lxc:0'
    nova-compute:
      charm: cs:~plumgrid-team/trusty/nova-compute
      num_units: 1
      options:
        enable-live-migration: true
        enable-resize: true
        migration-auth-type: ssh
        openstack-origin: cloud:trusty-juno
    rabbitmq-server:
      charm: cs:trusty/rabbitmq-server
      num_units: 1
      to: 'lxc:0'
